<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Google Authenticator验证的php客户端 - LuoJi.men</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="format-detection" content="telphone=no, email=no">
    <meta name="keywords" content="authenticator,google,php">
    <meta name="description" itemprop="description" content="web在线版 通过网页打开，方便自己多设备上查询登录。 计算代码如下 参考：用php计算Google Authenticator二次验证的验证码 https://www.529i.com/archiv [&hellip;]">
    <meta name="theme-color" content="#282a2c">
    <meta itemprop="image" content="https://luoji.men/wp-content/themes/kratos-4.1.2/assets/img/default.jpg" />
        <meta name='description' content='web在线版 通过网页打开，方便自己多设备上查询登录。 计算代码如下 参考：用php计算Google Authenticator二次验证的验证码 https://www.529i.com/archiv [&hellip;]' />
<meta name='keywords' content='authenticator,google,php' />
<meta name='robots' content='max-image-preview:large' />
<link rel='dns-prefetch' href='//cdn.seatonjiang.com' />
<link rel='dns-prefetch' href='//zz.bdstatic.com' />
<link rel='stylesheet' id='urvanov_syntax_highlighter-css'  href='/wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css?ver=2.8.27' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-classic-css'  href='/wp-content/plugins/urvanov-syntax-highlighter/themes/classic/classic.css?ver=2.8.27' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='/wp-content/plugins/urvanov-syntax-highlighter/fonts/monaco.css?ver=2.8.27' type='text/css' media='all' />
<style id='global-styles-inline-css' type='text/css'>
body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
</style>
<link rel='stylesheet' id='bootstrap-css'  href='https://cdn.seatonjiang.com/kratos/4.1.2/assets/css/bootstrap.min.css?ver=4.5.0' type='text/css' media='all' />
<link rel='stylesheet' id='kicon-css'  href='https://cdn.seatonjiang.com/kratos/4.1.2/assets/css/iconfont.min.css?ver=4.1.2' type='text/css' media='all' />
<link rel='stylesheet' id='layer-css'  href='https://cdn.seatonjiang.com/kratos/4.1.2/assets/css/layer.min.css?ver=3.1.1' type='text/css' media='all' />
<link rel='stylesheet' id='lightgallery-css'  href='https://cdn.seatonjiang.com/kratos/4.1.2/assets/css/lightgallery.min.css?ver=1.4.0' type='text/css' media='all' />
<link rel='stylesheet' id='kratos-css'  href='https://cdn.seatonjiang.com/kratos/4.1.2/style.css?ver=4.1.2' type='text/css' media='all' />
<style id='kratos-inline-css' type='text/css'>

        @media screen and (min-width: 992px) {
            .k-nav .navbar-brand h1 {
                color: #ffffff;
            }
            .k-nav .navbar-nav > li.nav-item > a {
                color: #ffffff;
            }
        }
        
.sticky-sidebar {
                position: sticky;
                top: 8px;
                height: 100%;
            }
</style>
<link rel="alternate" type="application/json+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.luoji.men%2F2019%2F05%2Fgoogle-authenticator%25e9%25aa%258c%25e8%25af%2581%25e7%259a%2584php%25e5%25ae%25a2%25e6%2588%25b7%25e7%25ab%25af-4%2F" />
<link rel="alternate" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.luoji.men%2F2019%2F05%2Fgoogle-authenticator%25e9%25aa%258c%25e8%25af%2581%25e7%259a%2584php%25e5%25ae%25a2%25e6%2588%25b7%25e7%25ab%25af-4%2F&#038;format=xml" />
<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><!-- 谷歌收录的验证方式 -->
<meta name="google-site-verification" content="XxPfUFFG0MmfvRUNs2AFXHfRXRx_xVLXdD_6Si95rJ0" />
<!-- bing收录验证luojimen.netlify.app -->
<meta name="msvalidate.01" content="508C6C00EA05098C32CD4DB253B3CB66" />
<!-- baidu收录验证luojimen.netlify.app -->
<meta name="baidu-site-verification" content="code-DlUhxrKYUP" />
		
		<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());

		  gtag('config', '');
		</script>

				<script type="text/javascript">
		var _hmt = _hmt || [];
				_hmt.push(['_trackPageview']);
						(function() {
		var hm = document.createElement("script");
		hm.src = "//hm.baidu.com/hm.js?cff4b8fde8a7abf46d402c4fd284f0cc";
		hm.setAttribute('async', 'true');
		document.getElementsByTagName('head')[0].appendChild(hm);
		})();
		</script>
		    <script type='text/javascript' src='https://cdn.seatonjiang.com/kratos/4.1.2/assets/js/jquery.min.js?ver=3.4.1' id='jquery-js'></script>
    </head>

<body>
    <script type="text/javascript">  
    $(function() {  
    $('.content img').each(function(i){  
        if (! this.parentNode.href) {  
            $(this).wrap("<a href='"+this.src+"' class='highslide-image' onclick='return hs.expand(this);'></a>");  
                                    }  
                                            });  
                });  
    </script> 
    <div class="k-header">
        <nav class="k-nav navbar navbar-expand-lg navbar-light fixed-top" style="background:#1e73be">
            <div class="container">
                <a class="navbar-brand" href="http://luojimen.netlify.app">
                    <h1>LuoJi.men</h1>                </a>
                                    <button class="navbar-toggler navbar-toggler-right" id="navbutton" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                        <span class="line first-line"></span>
                        <span class="line second-line"></span>
                        <span class="line third-line"></span>
                    </button>
                <div id="navbarResponsive" class="collapse navbar-collapse"><ul id="menu-menu-1" class="navbar-nav ml-auto"><li class="nav-item" ><a title="首页" href="https://luoji.men/" class="nav-link">首页</a></li>
<li class="nav-item" ><a title="在线工具站" href="/online-tool-station/" class="nav-link">在线工具站</a></li>
<li class="nav-item" ><a title="运维log" href="/%e8%bf%90%e7%bb%b4log/" class="nav-link">运维log</a></li>
<li class="nav-item" ><a title="归档时间轴" href="/time/" class="nav-link">归档时间轴</a></li>
</ul></div>            </div>
        </nav>
            </div>
<div class="k-main color" style="background:#f5f5f5">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 details">
                                    <div class="article">
                        <div class="breadcrumb-box">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item">
                                    <a class="text-dark" href="https://luojimen.netlify.app"> 首页</a>
                                </li>
                                <li class="breadcrumb-item"> <a class="text-dark" href="/category/linux/">Linux</a></li>                                <li class="breadcrumb-item active" aria-current="page"> 正文</li>
                            </ol>
                        </div>
                        <div class="header">
                            <h1 class="title">Google Authenticator验证的php客户端</h1>
                            <div class="meta">
                                <span>2019年5月10日</span>
                                                                    <span>390点热度</span>
                                                                                            </div>
                        </div>
                        <div class="content" id="lightgallery">
                            <div style="margin-bottom:5px"><a href="" target="_blank" rel="noreferrer"><img src=""></a></div><div id="MathJax_Message" style="display: none;"></div>
<p>web在线版 <br />
通过网页打开，方便自己多设备上查询登录。</p>
<p>计算代码如下 <br />
 参考：用php计算Google Authenticator二次验证的验证码 <br />
<a href="https://www.529i.com/archives/611.html" target="_blank"  rel="nofollow" >https://www.529i.com/archives/611.html</a></p>
<p>新建GoogleAuthenticator.php</p>
<div data-mode="php"><!-- Urvanov Syntax Highlighter v2.8.27 -->

		<div id="urvanov-syntax-highlighter-630f52fa4d3d9473965429" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea  class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?php
class PHPGangsta_GoogleAuthenticator
{
    protected $_codeLength = 6;

    public function createSecret($secretLength = 16)
    {
        $validChars = $this-&gt;_getBase32LookupTable();

        if ($secretLength &lt; 16 || $secretLength &gt; 128) {
            throw new Exception('Bad secret length');
        }
        $secret = '';
        $rnd = false;
        if (function_exists('random_bytes')) {
            $rnd = random_bytes($secretLength);
        } elseif (function_exists('mcrypt_create_iv')) {
            $rnd = mcrypt_create_iv($secretLength, MCRYPT_DEV_URANDOM);
        } elseif (function_exists('openssl_random_pseudo_bytes')) {
            $rnd = openssl_random_pseudo_bytes($secretLength, $cryptoStrong);
            if (!$cryptoStrong) {
                $rnd = false;
            }
        }
        if ($rnd !== false) {
            for ($i = 0; $i &lt; $secretLength; ++$i) {
                $secret .= $validChars[ord($rnd[$i]) &amp; 31];
            }
        } else {
            throw new Exception('No source of secure random');
        }

        return $secret;
    }
    public function getCode($secret, $timeSlice = null)
    {
        if ($timeSlice === null) {
            $timeSlice = floor(time() / 30);
        }

        $secretkey = $this-&gt;_base32Decode($secret);

        $time = chr(0).chr(0).chr(0).chr(0).pack('N*', $timeSlice);

        $hm = hash_hmac('SHA1', $time, $secretkey, true);

        $offset = ord(substr($hm, -1)) &amp; 0x0F;

        $hashpart = substr($hm, $offset, 4);

        $value = unpack('N', $hashpart);
        $value = $value[1];

        $value = $value &amp; 0x7FFFFFFF;

        $modulo = pow(10, $this-&gt;_codeLength);

        return str_pad($value % $modulo, $this-&gt;_codeLength, '0', STR_PAD_LEFT);
    }

    public function getQRCodeGoogleUrl($name, $secret, $title = null, $params = array())
    {
        $width = !empty($params['width']) &amp;&amp; (int) $params['width'] &gt; 0 ? (int) $params['width'] : 200;
        $height = !empty($params['height']) &amp;&amp; (int) $params['height'] &gt; 0 ? (int) $params['height'] : 200;
        $level = !empty($params['level']) &amp;&amp; array_search($params['level'], array('L', 'M', 'Q', 'H')) !== false ? $params['level'] : 'M';

        $urlencoded = urlencode('otpauth://totp/'.$name.'?secret='.$secret.'');
        if (isset($title)) {
            $urlencoded .= urlencode('&amp;issuer='.urlencode($title));
        }

        return 'https://chart.googleapis.com/chart?chs='.$width.'x'.$height.'&amp;chld='.$level.'|0&amp;cht=qr&amp;chl='.$urlencoded.'';
    }

    public function verifyCode($secret, $code, $discrepancy = 1, $currentTimeSlice = null)
    {
        if ($currentTimeSlice === null) {
            $currentTimeSlice = floor(time() / 30);
        }

        if (strlen($code) != 6) {
            return false;
        }

        for ($i = -$discrepancy; $i &lt;= $discrepancy; ++$i) {
            $calculatedCode = $this-&gt;getCode($secret, $currentTimeSlice + $i);
            if ($this-&gt;timingSafeEquals($calculatedCode, $code)) {
                return true;
            }
        }

        return false;
    }

    public function setCodeLength($length)
    {
        $this-&gt;_codeLength = $length;

        return $this;
    }

    protected function _base32Decode($secret)
    {
        if (empty($secret)) {
            return '';
        }

        $base32chars = $this-&gt;_getBase32LookupTable();
        $base32charsFlipped = array_flip($base32chars);

        $paddingCharCount = substr_count($secret, $base32chars[32]);
        $allowedValues = array(6, 4, 3, 1, 0);
        if (!in_array($paddingCharCount, $allowedValues)) {
            return false;
        }
        for ($i = 0; $i &lt; 4; ++$i) {
            if ($paddingCharCount == $allowedValues[$i] &amp;&amp;
                substr($secret, -($allowedValues[$i])) != str_repeat($base32chars[32], $allowedValues[$i])) {
                return false;
            }
        }
        $secret = str_replace('=', '', $secret);
        $secret = str_split($secret);
        $binaryString = '';
        for ($i = 0; $i &lt; count($secret); $i = $i + 8) {
            $x = '';
            if (!in_array($secret[$i], $base32chars)) {
                return false;
            }
            for ($j = 0; $j &lt; 8; ++$j) {
                $x .= str_pad(base_convert(@$base32charsFlipped[@$secret[$i + $j]], 10, 2), 5, '0', STR_PAD_LEFT);
            }
            $eightBits = str_split($x, 8);
            for ($z = 0; $z &lt; count($eightBits); ++$z) {
                $binaryString .= (($y = chr(base_convert($eightBits[$z], 2, 10))) || ord($y) == 48) ? $y : '';
            }
        }

        return $binaryString;
    }

    protected function _getBase32LookupTable()
    {
        return array(
            'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', //  7
            'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', // 15
            'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', // 23
            'Y', 'Z', '2', '3', '4', '5', '6', '7', // 31
            '=',
        );
    }

    private function timingSafeEquals($safeString, $userString)
    {
        if (function_exists('hash_equals')) {
            return hash_equals($safeString, $userString);
        }
        $safeLen = strlen($safeString);
        $userLen = strlen($userString);

        if ($userLen != $safeLen) {
            return false;
        }

        $result = 0;

        for ($i = 0; $i &lt; $userLen; ++$i) {
            $result |= (ord($safeString[$i]) ^ ord($userString[$i]));
        }

        return $result === 0;
    }
}</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-51">51</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-52">52</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-53">53</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-54">54</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-55">55</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-56">56</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-57">57</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-58">58</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-59">59</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-60">60</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-61">61</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-62">62</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-63">63</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-64">64</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-65">65</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-66">66</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-67">67</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-68">68</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-69">69</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-70">70</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-71">71</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-72">72</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-73">73</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-74">74</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-75">75</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-76">76</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-77">77</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-78">78</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-79">79</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-80">80</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-81">81</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-82">82</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-83">83</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-84">84</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-85">85</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-86">86</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-87">87</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-88">88</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-89">89</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-90">90</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-91">91</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-92">92</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-93">93</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-94">94</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-95">95</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-96">96</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-97">97</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-98">98</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-99">99</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-100">100</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-101">101</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-102">102</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-103">103</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-104">104</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-105">105</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-106">106</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-107">107</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-108">108</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-109">109</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-110">110</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-111">111</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-112">112</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-113">113</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-114">114</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-115">115</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-116">116</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-117">117</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-118">118</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-119">119</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-120">120</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-121">121</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-122">122</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-123">123</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-124">124</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-125">125</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-126">126</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-127">127</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-128">128</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-129">129</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-130">130</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-131">131</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-132">132</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-133">133</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-134">134</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-135">135</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-136">136</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-137">137</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-138">138</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-139">139</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-140">140</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-141">141</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-142">142</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-143">143</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-144">144</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-145">145</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-146">146</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-147">147</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-148">148</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-149">149</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-150">150</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-151">151</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-152">152</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-153">153</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-154">154</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-155">155</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-156">156</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-157">157</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-158">158</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-159">159</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-160">160</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-161">161</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-162">162</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-163">163</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-164">164</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-165">165</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-166">166</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-167">167</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-168">168</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-169">169</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-170">170</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-171">171</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-172">172</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3d9473965429-173">173</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-1"><span class="crayon-o">&lt;</span><span class="crayon-sy">?</span><span class="crayon-e">php</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-2"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">PHPGangsta_GoogleAuthenticator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-3"><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">protected</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">_codeLength</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">createSecret</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secretLength</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">validChars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">_getBase32LookupTable</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secretLength</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">secretLength</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">throw</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-sy">(</span><span class="crayon-s">'Bad secret length'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rnd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">function_exists</span><span class="crayon-sy">(</span><span class="crayon-s">'random_bytes'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rnd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">random_bytes</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secretLength</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">function_exists</span><span class="crayon-sy">(</span><span class="crayon-s">'mcrypt_create_iv'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rnd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">mcrypt_create_iv</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secretLength</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">MCRYPT_DEV_URANDOM</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">elseif</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">function_exists</span><span class="crayon-sy">(</span><span class="crayon-s">'openssl_random_pseudo_bytes'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rnd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">openssl_random_pseudo_bytes</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secretLength</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">cryptoStrong</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-sy">$</span><span class="crayon-v">cryptoStrong</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">rnd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">rnd</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">secretLength</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">secret</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">validChars</span><span class="crayon-sy">[</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">rnd</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">throw</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">Exception</span><span class="crayon-sy">(</span><span class="crayon-s">'No source of secure random'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-32">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getCode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">timeSlice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">timeSlice</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">timeSlice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">floor</span><span class="crayon-sy">(</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">secretkey</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">_base32Decode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-42">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">pack</span><span class="crayon-sy">(</span><span class="crayon-s">'N*'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">timeSlice</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-44">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">hm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hash_hmac</span><span class="crayon-sy">(</span><span class="crayon-s">'SHA1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">time</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">secretkey</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-46">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">offset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-e">substr</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">hm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0x0F</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-48">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">hashpart</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">substr</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">hm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">offset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-50">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">unpack</span><span class="crayon-sy">(</span><span class="crayon-s">'N'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">hashpart</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-52"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0x7FFFFFFF</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-55">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-56"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">modulo</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">pow</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-v">_codeLength</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-57">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">str_pad</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">modulo</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-v">_codeLength</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">STR_PAD_LEFT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-60">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-61"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">getQRCodeGoogleUrl</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">width</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-e">empty</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'width'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'width'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'width'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">height</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-e">empty</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'height'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'height'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'height'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">level</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-e">empty</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'level'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-e">array_search</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'level'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-s">'L'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'M'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Q'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'H'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!==</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">params</span><span class="crayon-sy">[</span><span class="crayon-s">'level'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'M'</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-66">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-67"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">urlencoded</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">urlencode</span><span class="crayon-sy">(</span><span class="crayon-s">'otpauth://totp/'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">name</span><span class="crayon-sy">.</span><span class="crayon-s">'?secret='</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">.</span><span class="crayon-s">''</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-68"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">isset</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">title</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-69"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">urlencoded</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">urlencode</span><span class="crayon-sy">(</span><span class="crayon-s">'&amp;issuer='</span><span class="crayon-sy">.</span><span class="crayon-e">urlencode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">title</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-70"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-71">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-72"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">'https://chart.googleapis.com/chart?chs='</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">width</span><span class="crayon-sy">.</span><span class="crayon-s">'x'</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">height</span><span class="crayon-sy">.</span><span class="crayon-s">'&amp;chld='</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">level</span><span class="crayon-sy">.</span><span class="crayon-s">'|0&amp;cht=qr&amp;chl='</span><span class="crayon-sy">.</span><span class="crayon-sy">$</span><span class="crayon-v">urlencoded</span><span class="crayon-sy">.</span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-73"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-74">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">verifyCode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">code</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">discrepancy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">currentTimeSlice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-76"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-77"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">currentTimeSlice</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-t">null</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-78"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">currentTimeSlice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">floor</span><span class="crayon-sy">(</span><span class="crayon-e">time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-79"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-80">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-81"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">code</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-83"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-84">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-85"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-sy">$</span><span class="crayon-v">discrepancy</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">discrepancy</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-86"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">calculatedCode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">getCode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">currentTimeSlice</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-87"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">timingSafeEquals</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">calculatedCode</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">code</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-88"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-89"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-90"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-91">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-92"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-93"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-94">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-95"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">public</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">setCodeLength</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">length</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-96"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-97"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-v">_codeLength</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">length</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-98">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-99"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-100"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-101">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-102"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">protected</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">_base32Decode</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-103"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-104"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">empty</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-105"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-106"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-107">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-108"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">base32chars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-r">this</span><span class="crayon-o">-&gt;</span><span class="crayon-e">_getBase32LookupTable</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-109"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">base32charsFlipped</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">array_flip</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">base32chars</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-110">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-111"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">paddingCharCount</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">substr_count</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">base32chars</span><span class="crayon-sy">[</span><span class="crayon-cn">32</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-112"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">allowedValues</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-113"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">in_array</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">paddingCharCount</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">allowedValues</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-114"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-115"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-116"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-117"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">paddingCharCount</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">allowedValues</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-118"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">substr</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">allowedValues</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-e">str_repeat</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">base32chars</span><span class="crayon-sy">[</span><span class="crayon-cn">32</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">allowedValues</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-119"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-120"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-121"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-122"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_replace</span><span class="crayon-sy">(</span><span class="crayon-s">'='</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-123"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_split</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-124"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">binaryString</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-125"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-126"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-127"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">!</span><span class="crayon-e">in_array</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">base32chars</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-128"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-129"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-130"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-sy">$</span><span class="crayon-v">j</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-131"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">x</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_pad</span><span class="crayon-sy">(</span><span class="crayon-e">base_convert</span><span class="crayon-sy">(</span><span class="crayon-sy">@</span><span class="crayon-sy">$</span><span class="crayon-v">base32charsFlipped</span><span class="crayon-sy">[</span><span class="crayon-sy">@</span><span class="crayon-sy">$</span><span class="crayon-v">secret</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'0'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">STR_PAD_LEFT</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-132"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-133"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">eightBits</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str_split</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-134"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">eightBits</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-135"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-i">binaryString</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-e">base_convert</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">eightBits</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">z</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">48</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">?</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-136"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-137"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-138">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-139"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">binaryString</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-140"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-141">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-142"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">protected</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">_getBase32LookupTable</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-143"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-144"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">array</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-145"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'A'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'C'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'D'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'E'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'F'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'G'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'H'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">//&nbsp;&nbsp;7</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-146"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'I'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'J'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'K'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'L'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'M'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'N'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'O'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'P'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">// 15</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-147"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Q'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'R'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'S'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'T'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'U'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'V'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'W'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'X'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">// 23</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-148"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Y'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Z'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'3'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'4'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'5'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'6'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'7'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c">// 31</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-149"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'='</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-150"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-151"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-152">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-153"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-m">private</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">timingSafeEquals</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">safeString</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">userString</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-154"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-155"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">function_exists</span><span class="crayon-sy">(</span><span class="crayon-s">'hash_equals'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-156"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">hash_equals</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">safeString</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">userString</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-157"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-158"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">safeLen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">safeString</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-159"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">userLen</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">strlen</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">userString</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-160">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-161"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">userLen</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">safeLen</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-162"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">false</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-163"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-164">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-165"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-166">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-167"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">userLen</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-o">++</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-168"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">$</span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">|=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">safeString</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-e">ord</span><span class="crayon-sy">(</span><span class="crayon-sy">$</span><span class="crayon-v">userString</span><span class="crayon-sy">[</span><span class="crayon-sy">$</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-169"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-170">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-171"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">$</span><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">===</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-172"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3d9473965429-173"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0126 seconds] -->
</div>
<p>调用方法如下 <br />
新建index.php</p>
<div data-mode="php"><!-- Urvanov Syntax Highlighter v2.8.27 -->

		<div id="urvanov-syntax-highlighter-630f52fa4d3e1674191006" class="urvanov-syntax-highlighter-syntax crayon-theme-classic urvanov-syntax-highlighter-font-monaco urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"><textarea  class="urvanov-syntax-highlighter-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
&lt;?php

//调用上面计算代码保存的文件
require_once './GoogleAuthenticator.php';
$ga = new PHPGangsta_GoogleAuthenticator();
//要计算的key
$secret = "ZKU7DAJX7S33ZCPM";
echo "Key: ".$secret."\n\n";
$oneCode = $ga-&gt;getCode($secret); //服务端计算"一次性验证码"
echo "验证码:".$oneCode."\n\n";

?&gt;</textarea></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-630f52fa4d3e1674191006-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-1"><span class="crayon-ta">&lt;?php</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-3"><span class="crayon-c">//调用上面计算代码保存的文件</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-4"><span class="crayon-k ">require_once</span><span class="crayon-h"> </span><span class="crayon-s">'./GoogleAuthenticator.php'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-5"><span class="crayon-v">$ga</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">new</span><span class="crayon-h"> </span><span class="crayon-e">PHPGangsta_GoogleAuthenticator</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-6"><span class="crayon-c">//要计算的key</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-7"><span class="crayon-v">$secret</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"ZKU7DAJX7S33ZCPM"</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-8"><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"Key: "</span><span class="crayon-sy">.</span><span class="crayon-v">$secret</span><span class="crayon-sy">.</span><span class="crayon-s">"\n\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-9"><span class="crayon-v">$oneCode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">$ga</span><span class="crayon-o">-&gt;</span><span class="crayon-e">getCode</span><span class="crayon-sy">(</span><span class="crayon-v">$secret</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-c">//服务端计算"一次性验证码"</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-10"><span class="crayon-k ">echo</span><span class="crayon-h"> </span><span class="crayon-s">"验证码:"</span><span class="crayon-sy">.</span><span class="crayon-v">$oneCode</span><span class="crayon-sy">.</span><span class="crayon-s">"\n\n"</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-630f52fa4d3e1674191006-12"><span class="crayon-ta">?&gt;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0181 seconds] -->
</div>
<p>访问域名/index.php <br />
完成。</p>
<p><wiz_tmp_tag id="wiz-table-range-border" contenteditable="false" style="display: none;"></p>
<div id="wiz-table-col-line" style="display: none;"></div>
<div id="wiz-table-row-line" style="display: none;"></div>
<div id="wiz-table-range-border_start" style="display: none;">
<div id="wiz-table-range-border_start_top"></div>
<div id="wiz-table-range-border_start_right"></div>
<div id="wiz-table-range-border_start_bottom"></div>
<div id="wiz-table-range-border_start_left"></div>
<div id="wiz-table-range-border_start_dot"></div>
</div>
<div id="wiz-table-range-border_range" style="display: none;">
<div id="wiz-table-range-border_range_top"></div>
<div id="wiz-table-range-border_range_right"></div>
<div id="wiz-table-range-border_range_bottom"></div>
<div id="wiz-table-range-border_range_left"></div>
<div id="wiz-table-range-border_range_dot"></div>
</div>
<p></wiz_tmp_tag></p>
                        </div>
                                                <div class="footer clearfix">
                            <div class="tags float-left">
                                <span>标签：</span>
                                <a href="/tag/authenticator/" rel="tag">authenticator</a> <a href="/tag/google/" rel="tag">google</a> <a href="/tag/php/" rel="tag">php</a>                            </div>
                            <div class="tool float-right d-none d-lg-block">
                                <span>最后更新：2022年4月5日</span>
                            </div>
                        </div>
                    </div>
                                <div class="toolbar clearfix">
	<div class="meta float-md-left">
		<img src="https://sdn.geekzu.org/avatar/8dc48ab2afc8d5058df4be411bc61a15?s=96&r=g">
		<p class="name">SSJ</p>
		<p class="motto mb-0">不积跬步无以至千里</p>
	</div>
	<div class="share float-md-right text-center">
				<a href="javascript:;" id="thumbs" data-action="love" data-id="1814" role="button" class="btn btn-thumbs "><i class="kicon i-like"></i><span class="ml-1">点赞</span></a>
	</div>
</div>
                <nav class="navigation post-navigation clearfix" role="navigation">
                    <div class="nav-previous clearfix"><a title="hostloc一键获取积分shell脚本" href="/2019/05/hostloc-one-click-shell-script-for-getting-points/">< 上一篇</a></div><div class="nav-next"><a title="mailx通过smtp登录QQ邮箱发送邮件" href="/2019/05/mailx%e9%80%9a%e8%bf%87smtp%e7%99%bb%e5%bd%95qq%e9%82%ae%e7%ae%b1%e5%8f%91%e9%80%81%e9%82%ae%e4%bb%b6/">下一篇 ></a></div>                </nav>
                            </div>
                    </div>
    </div>
</div>
<div class="k-footer">
    <div class="f-toolbox">
        <div class="gotop ">
            <div class="gotop-btn">
                <span class="kicon i-up"></span>
            </div>
        </div>
                <div class="search">
            <span class="kicon i-find"></span>
            <form class="search-form" role="search" method="get" action="/">
                <input type="text" name="s" id="search-footer" placeholder="搜点什么呢?" style="display:none" />
            </form>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-12 text-center">
                <p class="social">
                                    </p>
                <p>COPYRIGHT © 2022 luoji.men. ALL RIGHTS RESERVED.</p><p>Theme <a href="https://github.com/seatonjiang/kratos" target="_blank" rel="nofollow">Kratos</a> Made By <a href="https://seatonjiang.com" target="_blank" rel="nofollow">Seaton Jiang</a></p><script></script>            </div>
        </div>
    </div>
</div>
<script type='text/javascript' id='urvanov_syntax_highlighter_js-js-extra'>
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.27","is_admin":"0","ajaxurl":"https:\/\/luojimen.netlify.app\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"\u70b9\u51fb\u5c55\u5f00\u4ee3\u7801"};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js?ver=2.8.27' id='urvanov_syntax_highlighter_js-js'></script>
<script type='text/javascript' id='image-sizes-js-extra'>
/* <![CDATA[ */
var IMAGE_SIZES = {"version":"3.5","disables":["thumbnail","medium","medium_large","large","1536x1536","2048x2048","kratos-thumbnail"]};
/* ]]> */
</script>
<script type='text/javascript' src='/wp-content/plugins/image-sizes/assets/js/front.min.js?ver=3.5' id='image-sizes-js'></script>
<script type='text/javascript' src='https://cdn.seatonjiang.com/kratos/4.1.2/assets/js/bootstrap.bundle.min.js?ver=4.5.0' id='bootstrap-bundle-js'></script>
<script type='text/javascript' src='https://cdn.seatonjiang.com/kratos/4.1.2/assets/js/layer.min.js?ver=3.1.1' id='layer-js'></script>
<script type='text/javascript' src='https://cdn.seatonjiang.com/kratos/4.1.2/assets/js/DPlayer.min.js?ver=4.1.2' id='dplayer-js'></script>
<script type='text/javascript' src='https://cdn.seatonjiang.com/kratos/4.1.2/assets/js/lightgallery.min.js?ver=1.4.0' id='lightgallery-js'></script>
<script type='text/javascript' id='kratos-js-extra'>
/* <![CDATA[ */
var kratos = {"site":"https:\/\/luojimen.netlify.app","directory":"https:\/\/cdn.seatonjiang.com\/kratos\/4.1.2","alipay":"https:\/\/luoji.men\/wp-content\/themes\/kratos-4.1.2\/assets\/img\/200.png","wechat":"https:\/\/luoji.men\/wp-content\/themes\/kratos-4.1.2\/assets\/img\/200.png","repeat":"\u60a8\u5df2\u7ecf\u8d5e\u8fc7\u4e86","thanks":"\u611f\u8c22\u60a8\u7684\u652f\u6301","donate":"\u6253\u8d4f\u4f5c\u8005","scan":"\u626b\u7801\u652f\u4ed8"};
/* ]]> */
</script>
<script type='text/javascript' src='https://cdn.seatonjiang.com/kratos/4.1.2/assets/js/kratos.js?ver=4.1.2' id='kratos-js'></script>
<script type='text/javascript' id='comment-js-extra'>
/* <![CDATA[ */
var ajaxcomment = {"ajax_url":"https:\/\/luojimen.netlify.app\/wp-admin\/admin-ajax.php","order":"asc","compost":"\u8bc4\u8bba\u6b63\u5728\u63d0\u4ea4\u4e2d","comsucc":"\u8bc4\u8bba\u63d0\u4ea4\u6210\u529f"};
/* ]]> */
</script>
<script type='text/javascript' src='https://cdn.seatonjiang.com/kratos/4.1.2/assets/js/comments.min.js?ver=4.1.2' id='comment-js'></script>
<script type='text/javascript' src='https://zz.bdstatic.com/linksubmit/push.js?ver=6.0.2' id='baidu_zz_push-js'></script>
</body>

</html>
