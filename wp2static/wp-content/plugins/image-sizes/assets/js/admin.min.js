jQuery(function(l){l(".image-sizes-help-heading").click(function(e){var t=l(this).data("target");l(".image-sizes-help-text:not("+t+")").slideUp(),l(t).is(":hidden")?l(t).slideDown():l(t).slideUp()});var e=l(".check-all"),t=l(".check-all-default"),a=l(".check-all-custom");e.change(function(){l(".check-all-default,.check-all-custom").prop("checked",this.checked).change()}),t.change(function(){l(".check-default").prop("checked",this.checked),l(".check-this").change()}),a.change(function(){l(".check-custom").prop("checked",this.checked),l(".check-this").change()}),l(".check-this").change(function(e){l(".check-this").length;var t=l(".check-this:not(:checked)").length,a=l(".check-this:checked").length;l("#disabled-counter .counter").text(a),l("#enabled-counter .counter").text(t)}).change();var s=l("#image-sizes_regenerate-thumbs-limit").val();l("#image-sizes_regenerate-thumbs-limit").bind("keyup mouseup",function(){s=l(this).val()});function i(e){e.draggable({connectToSortable:"#sortable2",stack:".draggable-item",revert:!0,revertDuration:200,start:function(e,t){l("#sortable1").sortable("disable")}})}l("#image_sizes-regen-thumbs").click(function(e){l("#image_sizes-regen-thumbs").text(IMAGE_SIZES.regening).attr("disabled",!0),l("#image_sizes-message").html("").hide(),l(".image-sizes-progress-panel").hide(),function a(s,e,t,i){l.ajax({url:IMAGE_SIZES.ajaxurl,type:"GET",data:{action:"image_sizes-regen-thumbs",offset:e,limit:s,thumbs_deleteds:t,thumbs_createds:i,_nonce:IMAGE_SIZES.nonce},success:function(e){var t;e.has_image?(t=e.offset/e.total_images_count*100,l(".image-sizes-progress-content").text(Math.ceil(t)+"%").css({width:t+"%"}),a(s,e.offset,e.thumbs_deleted,e.thumbs_created)):(l("#image_sizes-regen-thumbs").text(IMAGE_SIZES.regen).attr("disabled",!1),l("#image_sizes-message").html(e.message).show(),l(".image-sizes-progress-panel .image-sizes-progress-content").addClass("progress-full")),console.log(e)},error:function(e){l("#image_sizes-regen-thumbs").text(IMAGE_SIZES.regen).attr("disabled",!1),console.log(e)}})}(s,0,0,0),l("#image_sizes-regen-thumbs").after('<div class="image-sizes-progress-panel"><div class="image-sizes-progress-content" style="width:0%"><span>0%</span></div></div></div>')}),l(".image_sizes-dismiss").click(function(e){var t=l(this);t.parent().slideToggle(),l.ajax({url:IMAGE_SIZES.ajaxurl,data:{action:"image_sizes-dismiss",meta_key:t.data("meta_key"),_nonce:IMAGE_SIZES.nonce},type:"GET",success:function(e){console.log(e)},error:function(e){console.log(e)}})}),l("#image_sizes-regen-wrap span").click(function(e){alert(l(this).attr("title"))}),l(document).on("click","#cx-optimized",function(e){l("#cx-nav-label-image-sizes_optimize").trigger("click")}),l(".image_sizes-action").click(function(e){e.preventDefault(),l("#image_sizes-optimize").attr("disabled",!0),l("#image_sizes-pro-message").html("");var e=l("#cx-free-optimize #cx-optimize"),t=l(this),e=e.serializeArray(),a="analyze"==l(this).attr("name")?"analyze":"optimize";t.val("optimize"==a?IMAGE_SIZES.optimizing:IMAGE_SIZES.analyzing).attr("disabled",!0),e.push({name:"operation",value:a}),l.ajax({url:ajaxurl,type:"POST",data:e,dataType:"JSON",success:function(e){1==e.status&&l("#image_sizes-optimize").attr("disabled",!1),t.val("optimize"==a?IMAGE_SIZES.optimize:IMAGE_SIZES.analyze).attr("disabled",!1),console.log(e),l("#image_sizes-pro-message").html(e.html)},error:function(e){t.val("optimize"==a?IMAGE_SIZES.optimize:IMAGE_SIZES.analyze).attr("disabled",!1),console.log(e)}})}),i(l(".draggable-item")),l("#sortable2").sortable({connectWith:"#sortable1, #sortable2",items:".draggable-item, .sortable-item",start:function(e,t){l("#sortable1").sortable("enable"),l("ul.image_sizes-sortable.disable li input").attr("name","disables[]");var a=l("ul.image_sizes-sortable.disable li").length-1;l(".image_sizes-default-thumbnails-panel h4 .disables-count").text(a);a=l("ul.image_sizes-sortable.enable li").length;l(".image_sizes-default-thumbnails-panel h4 .enables-count").text(a)},receive:function(e,t){t.item.hasClass("ui-draggable")&&t.item.draggable("destroy")}}),l("#sortable1").sortable({connectWith:"#sortable1, #sortable2",items:".draggable-item, .sortable-item",receive:function(e,t){l("#sortable1").sortable("disable"),i(t.item),l("ul.image_sizes-sortable.enable li input").attr("name","");t=l("ul.image_sizes-sortable.disable li").length;l(".image_sizes-default-thumbnails-panel h4 .disables-count").text(t);t=l("ul.image_sizes-sortable.enable li").length;l(".image_sizes-default-thumbnails-panel h4 .enables-count").text(t)}})});